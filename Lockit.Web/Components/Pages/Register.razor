@page "/register"

@if (registrationDone == false)
{
	<EditForm Model="@locker" OnValidSubmit="OnValidSubmit">
		<DataAnnotationsValidator />
		<MudGrid>
			<MudItem Class="ma-5">
				<MudTextField Label="Name" @bind-Value="@locker.Student.Name"></MudTextField>
				<MudTextField Label="Lastname" @bind-Value="@locker.Student.LastName"></MudTextField>
				<MudTextField Label="Class" @bind-Value="@locker.Student.Class"></MudTextField>
				<MudButton ButtonType="ButtonType.Submit">Register</MudButton>
			</MudItem>
		</MudGrid>
	</EditForm>
}
else
{
	<MudAlert Severity="Severity.Success">Registration successful!</MudAlert>
}


@code {
	[Inject]
	public LockerService LockerService { get; set; }
	private Locker locker = new Locker();

	private bool registrationDone = false;

	protected override async Task OnInitializedAsync()
	{
		InitializeEmptyLocker();
	}

	private async Task OnValidSubmit()
	{
		bool success = true; // await LockerService.RegisterLocker(locker);
		if (success)
		{
			registrationDone = true;
			InitializeEmptyLocker();
		}
	}

	private void InitializeEmptyLocker()
	{
		locker = new Locker();
		locker.Student = new Student();
	}
}
